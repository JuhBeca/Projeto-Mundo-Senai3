<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Corrida do Conhecimento</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f0f0f0;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }
        
        #start-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            color: white;
        }
        
        #start-screen h1 {
            font-size: 2.5em;
            margin-bottom: 20px;
            color: #ffcc00;
        }
        
        #start-screen input {
            padding: 10px;
            font-size: 1.2em;
            margin-bottom: 20px;
            width: 300px;
            border-radius: 5px;
            border: none;
        }
        
        #start-screen button {
            padding: 15px 30px;
            font-size: 1.2em;
            background-color: #ffcc00;
            color: #333;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        #start-screen button:hover {
            background-color: #ffdd33;
        }
        
        #game-container {
            position: relative;
            width: 100%;
            height: 100vh;
            background-color: #52d8dd;
            overflow: hidden;
        }
        
        #road {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 150px;
            background-color: #333;
            border-top: 5px dashed #fff;
        }
        
        #car {
            position: absolute;
            bottom: 20px;
            left: 50px;
            width: 80px;
            height: 50px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 60"><rect x="10" y="20" width="80" height="20" fill="red"/><rect x="20" y="10" width="60" height="10" fill="red"/><circle cx="25" cy="40" r="10" fill="black"/><circle cx="75" cy="40" r="10" fill="black"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
            transition: left 0.5s ease-in-out;
            z-index: 10;
        }
        
        #finish-line {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 20px;
            height: 150px;
            background-color: #fff;
            border-left: 5px dashed #000;
            z-index: 5;
        }
        
        #question-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
            width: 70%;
            max-width: 600px;
            text-align: center;
            z-index: 20;
        }
        
        #question {
            font-size: 1.2em;
            margin-bottom: 20px;
            color: #333;
        }
        
        .option {
            display: block;
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            background-color: #4485da;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .option:hover {
            background-color: #6dafe6;
        }
        
        #lives-container {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
        }
        
        .heart {
            width: 30px;
            height: 30px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="red" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
        }
        
        #score {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 1.2em;
            color: white;
            background-color: rgba(0, 0, 0, 0.5);
            padding: 5px 10px;
            border-radius: 5px;
        }
        
        #difficulty {
            position: absolute;
            top: 60px;
            left: 20px;
            font-size: 1.2em;
            color: white;
            background-color: rgba(0, 0, 0, 0.5);
            padding: 5px 10px;
            border-radius: 5px;
        }
        
        #streak {
            position: absolute;
            top: 100px;
            left: 20px;
            font-size: 1.2em;
            color: white;
            background-color: rgba(0, 0, 0, 0.5);
            padding: 5px 10px;
            border-radius: 5px;
        }
        
        #correct-answers {
            position: absolute;
            top: 140px;
            left: 20px;
            font-size: 1.2em;
            color: white;
            background-color: rgba(0, 0, 0, 0.5);
            padding: 5px 10px;
            border-radius: 5px;
        }
        
        #game-over, #win-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 30;
            color: white;
        }
        
        #game-over h2, #win-screen h2 {
            font-size: 2.5em;
            margin-bottom: 20px;
            color: #ff4444;
        }
        
        #win-screen h2 {
            color: #4CAF50;
        }
        
        #final-score {
            font-size: 1.5em;
            margin-bottom: 20px;
        }
        
        #return-button, #return-button-win {
            padding: 15px 30px;
            font-size: 1.2em;
            background-color: #ffcc00;
            color: #333;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-bottom: 10px;
        }
        
        #return-button:hover, #return-button-win:hover {
            background-color: #ffdd33;
        }
        
        #clear-leaderboard, #clear-leaderboard-win {
            padding: 15px 30px;
            font-size: 1.2em;
            background-color: #ff4444;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-bottom: 20px;
        }
        
        #clear-leaderboard:hover, #clear-leaderboard-win:hover {
            background-color: #ff6666;
        }
        
        #leaderboard {
            margin-top: 10px;
            width: 300px;
            background-color: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
        }
        
        #leaderboard h3 {
            margin-top: 0;
            text-align: center;
            color: #ffcc00;
        }
        
        #leaderboard-list {
            list-style-type: none;
            padding: 0;
        }
        
        #leaderboard-list li {
            padding: 5px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            justify-content: space-between;
        }
        
        .cloud {
            position: absolute;
            background-color: white;
            border-radius: 50%;
            opacity: 0.8;
        }
    </style>
</head>
    
<body>
    <div id="start-screen">
        <h1>Corrida do Conhecimento</h1>
        <input type="text" id="player-name" placeholder="Digite seu nome" required>
        <button id="start-button">Iniciar Corrida</button>
    </div>

    <div id="game-container">
        <div id="road"></div>
        <div id="car"></div>
        <div id="finish-line"></div>
        
        <div id="question-container">
            <div id="question">Pergunta aparecerá aqui</div>
            <button class="option" id="option1">Opção 1</button>
            <button class="option" id="option2">Opção 2</button>
            <button class="option" id="option3">Opção 3</button>
        </div>
        
        <div id="lives-container">
            <div class="heart"></div>
            <div class="heart"></div>
            <div class="heart"></div>
        </div>
        
        <div id="score">Pontos: 0</div>
        <div id="difficulty">Dificuldade: Fácil</div>
        <div id="streak">Sequência: 0</div>
        <div id="correct-answers">Acertos: 0/7</div>
        
        <div id="game-over">
            <h2>Fim de Jogo!</h2>
            <div id="final-score">Sua pontuação: <span id="score-display">0</span></div>
            <button id="return-button">Voltar ao Início</button>
            <button id="clear-leaderboard">Limpar Placar</button>
            <div id="leaderboard">
                <h3>Placar de Líderes</h3>
                <ul id="leaderboard-list"></ul>
            </div>
        </div>
        
        <div id="win-screen">
            <h2>Você Venceu!</h2>
            <div id="final-score-win">Sua pontuação: <span id="score-display-win">0</span></div>
            <button id="return-button-win">Voltar ao Início</button>
            <button id="clear-leaderboard-win">Limpar Placar</button>
            <div id="leaderboard-win">
                <h3>Placar de Líderes</h3>
                <ul id="leaderboard-list-win"></ul>
            </div>
        </div>
    </div>

    <script>
        // Variáveis do jogo
        let playerName = '';
        let score = 0;
        let lives = 3;
        let streak = 0;
        let correctAnswersCount = 0;
        let difficulty = 0; // 0 = fácil, 1 = médio, 2 = difícil
        const difficulties = ["Fácil", "Médio", "Difícil"];
        
        const easyQuestions = [
            {
                question: "Qual a probabilidade de sair cara em um lançamento de moeda justa?",
                options: ["25%", "50%", "75%"],
                correct: 1,
                explanation: "Em uma moeda justa, há duas possibilidades igualmente prováveis: cara ou coroa, portanto 50% para cada."
            },
            {
                question: "Em uma sala com 5 homens e 5 mulheres, qual a chance de sortear uma mulher?",
                options: ["25%", "50%", "75%"],
                correct: 1,
                explanation: "5 mulheres em 10 pessoas totais: 5/10 = 0.5 ou 50%."
            },
            {
                question: "Se a probabilidade de chover é 30%, qual a probabilidade de não chover?",
                options: ["30%", "70%", "Não é possível determinar"],
                correct: 1,
                explanation: "Probabilidade do complementar: 100% - 30% = 70%."
            },
            {
                question: "Em um sorteio com 20 números, qual a chance de seu único bilhete ser sorteado?",
                options: ["1/20", "1/10", "1/5"],
                correct: 0,
                explanation: "1 bilhete favorável em 20 possíveis: 1/20."
            }
        ];
        
        const mediumQuestions = [
            {
                question: "Qual a probabilidade de obter um número par ao lançar um dado de 6 faces?",
                options: ["1/6", "1/3", "1/2"],
                correct: 2,
                explanation: "Há 3 números pares (2, 4, 6) em 6 possibilidades totais, portanto 3/6 = 1/2."
            },
            {
                question: "Em uma urna com 3 bolas vermelhas e 2 azuis, qual a probabilidade de tirar uma vermelha?",
                options: ["30%", "60%", "50%"],
                correct: 1,
                explanation: "Probabilidade = casos favoráveis / casos totais = 3/(3+2) = 3/5 = 60%."
            },
            {
                question: "Qual a probabilidade de não sair o número 1 ao lançar um dado?",
                options: ["1/6", "5/6", "1/3"],
                correct: 1,
                explanation: "Probabilidade do complementar: 1 - P(sair 1) = 1 - 1/6 = 5/6."
            },
            {
                question: "Qual a probabilidade de tirar um valete de um baralho de 52 cartas?",
                options: ["1/52", "1/26", "1/13"],
                correct: 2,
                explanation: "Há 4 valetes em 52 cartas, então 4/52 = 1/13."
            }
        ];
        
        const hardQuestions = [
            {
                question: "Qual a probabilidade de sair cara duas vezes ao lançar uma moeda duas vezes?",
                options: ["25%", "50%", "75%"],
                correct: 0,
                explanation: "Probabilidade de dois eventos independentes: 0.5 * 0.5 = 0.25 ou 25%."
            },
            {
                question: "Qual a probabilidade de tirar uma carta de copas de um baralho?",
                options: ["1/4", "1/13", "1/52"],
                correct: 0,
                explanation: "Há 13 cartas de copas em 52: 13/52 = 1/4."
            },
            {
                question: "Se você tem 1 chance em 4 de ganhar, qual sua probabilidade de perder?",
                options: ["25%", "50%", "75%"],
                correct: 2,
                explanation: "Probabilidade do complementar: 1 - 1/4 = 3/4 = 75%."
            },
            {
                question: "Qual a probabilidade de obter soma 7 ao lançar dois dados?",
                options: ["1/6", "1/12", "1/36"],
                correct: 0,
                explanation: "Há 6 combinações que somam 7 em 36 possíveis: 6/36 = 1/6."
            }
        ];
        
        let currentQuestion = {};
        let leaderboard = JSON.parse(localStorage.getItem('leaderboard')) || [];

        // Elementos do DOM
        const startScreen = document.getElementById('start-screen');
        const playerNameInput = document.getElementById('player-name');
        const startButton = document.getElementById('start-button');
        const gameContainer = document.getElementById('game-container');
        const car = document.getElementById('car');
        const questionElement = document.getElementById('question');
        const option1 = document.getElementById('option1');
        const option2 = document.getElementById('option2');
        const option3 = document.getElementById('option3');
        const livesContainer = document.getElementById('lives-container');
        const scoreElement = document.getElementById('score');
        const difficultyElement = document.getElementById('difficulty');
        const streakElement = document.getElementById('streak');
        const correctAnswersElement = document.getElementById('correct-answers');
        const gameOverScreen = document.getElementById('game-over');
        const winScreen = document.getElementById('win-screen');
        const scoreDisplay = document.getElementById('score-display');
        const scoreDisplayWin = document.getElementById('score-display-win');
        const returnButton = document.getElementById('return-button');
        const returnButtonWin = document.getElementById('return-button-win');
        const clearLeaderboardButton = document.getElementById('clear-leaderboard');
        const clearLeaderboardButtonWin = document.getElementById('clear-leaderboard-win');
        const leaderboardList = document.getElementById('leaderboard-list');
        const leaderboardListWin = document.getElementById('leaderboard-list-win');

        // Event Listeners
        startButton.addEventListener('click', startGame);
        option1.addEventListener('click', () => checkAnswer(0));
        option2.addEventListener('click', () => checkAnswer(1));
        option3.addEventListener('click', () => checkAnswer(2));
        returnButton.addEventListener('click', returnToStart);
        returnButtonWin.addEventListener('click', returnToStart);
        clearLeaderboardButton.addEventListener('click', clearLeaderboard);
        clearLeaderboardButtonWin.addEventListener('click', clearLeaderboard);

        // Funções do jogo
        function startGame() {
            if (playerNameInput.value.trim() === '') {
                alert('Por favor, digite seu nome!');
                return;
            }
            
            playerName = playerNameInput.value.trim();
            startScreen.style.display = 'none';
            resetGame();
            showQuestion();
            createClouds();
        }

        function resetGame() {
            score = 0;
            lives = 3;
            streak = 0;
            correctAnswersCount = 0;
            difficulty = 0;
            updateScore();
            updateLives();
            updateDifficulty();
            updateStreak();
            updateCorrectAnswers();
            car.style.left = '50px';
            // Marca todas as perguntas como não usadas
            easyQuestions.forEach(q => q.used = false);
            mediumQuestions.forEach(q => q.used = false);
            hardQuestions.forEach(q => q.used = false);
        }

        function showQuestion() {
            let availableQuestions = [];
            
            // Seleciona perguntas com base na dificuldade atual
            if (difficulty === 0) {
                availableQuestions = easyQuestions.filter(q => !q.used);
            } else if (difficulty === 1) {
                availableQuestions = mediumQuestions.filter(q => !q.used);
            } else {
                availableQuestions = hardQuestions.filter(q => !q.used);
            }
            
            // Se não houver perguntas disponíveis, marca todas como não usadas
            if (availableQuestions.length === 0) {
                if (difficulty === 0) {
                    easyQuestions.forEach(q => q.used = false);
                    availableQuestions = easyQuestions;
                } else if (difficulty === 1) {
                    mediumQuestions.forEach(q => q.used = false);
                    availableQuestions = mediumQuestions;
                } else {
                    hardQuestions.forEach(q => q.used = false);
                    availableQuestions = hardQuestions;
                }
            }
            
            // Seleciona uma pergunta aleatória
            currentQuestion = availableQuestions[Math.floor(Math.random() * availableQuestions.length)];
            currentQuestion.used = true;
            
            questionElement.textContent = currentQuestion.question;
            option1.textContent = currentQuestion.options[0];
            option2.textContent = currentQuestion.options[1];
            option3.textContent = currentQuestion.options[2];
        }

        function checkAnswer(selectedOption) {
            if (selectedOption === currentQuestion.correct) {
                // Resposta correta
                correctAnswersCount++;
                streak++;
                score += 200; // Pontos base por acerto
                
                // Bônus por sequência
                if (streak >= 3) {
                    score += 100;
                }
                
                // Aumenta a dificuldade após 2 acertos consecutivos
                if (streak >= 2 && difficulty < 2) {
                    difficulty++;
                    updateDifficulty();
                }
                
                updateScore();
                updateStreak();
                updateCorrectAnswers();
                moveCar();
                
                // Verifica vitória (7 acertos)
                if (correctAnswersCount >= 7) {
                    winGame();
                } else {
                    showQuestion();
                }
            } else {
                // Resposta errada
                streak = 0;
                score = Math.max(0, score - 50); // Penalidade por erro
                
                // Diminui a dificuldade
                if (difficulty > 0) {
                    difficulty--;
                    updateDifficulty();
                }
                
                lives--;
                updateScore();
                updateStreak();
                updateLives();
                
                if (lives <= 0) {
                    gameOver();
                } else {
                    alert(`Resposta incorreta!\nExplicação: ${currentQuestion.explanation}`);
                    showQuestion();
                }
            }
        }

        function moveCar() {
            const currentPosition = parseInt(car.style.left);
            const roadWidth = gameContainer.offsetWidth;
            const newPosition = currentPosition + (roadWidth / 5);
            
            if (newPosition >= roadWidth - 100) {
                car.style.left = (roadWidth - 100) + 'px';
            } else {
                car.style.left = newPosition + 'px';
            }
        }

        function updateScore() {
            scoreElement.textContent = `Pontos: ${score}`;
        }

        function updateDifficulty() {
            difficultyElement.textContent = `Dificuldade: ${difficulties[difficulty]}`;
        }

        function updateStreak() {
            streakElement.textContent = `Sequência: ${streak}`;
        }

        function updateCorrectAnswers() {
            correctAnswersElement.textContent = `Acertos: ${correctAnswersCount}/7`;
        }

        function updateLives() {
            const hearts = livesContainer.querySelectorAll('.heart');
            hearts.forEach((heart, index) => {
                if (index < lives) {
                    heart.style.display = 'block';
                } else {
                    heart.style.display = 'none';
                }
            });
        }

        function gameOver() {
            gameOverScreen.style.display = 'flex';
            scoreDisplay.textContent = score;
            updateLeaderboard();
        }

        function winGame() {
            winScreen.style.display = 'flex';
            scoreDisplayWin.textContent = score;
            updateLeaderboard();
        }

        function returnToStart() {
            gameOverScreen.style.display = 'none';
            winScreen.style.display = 'none';
            startScreen.style.display = 'flex';
            playerNameInput.value = '';
        }

        function updateLeaderboard() {
            // Adiciona o jogador atual ao placar
            leaderboard.push({ name: playerName, score: score });
            
            // Ordena o placar por pontuação (decrescente)
            leaderboard.sort((a, b) => b.score - a.score);
            
            // Mantém apenas os top 5
            if (leaderboard.length > 5) {
                leaderboard = leaderboard.slice(0, 5);
            }
            
            // Salva no localStorage
            localStorage.setItem('leaderboard', JSON.stringify(leaderboard));
            
            // Atualiza a exibição do placar
            updateLeaderboardDisplay();
        }

        function clearLeaderboard() {
            if (confirm('Tem certeza que deseja limpar o placar de líderes?')) {
                leaderboard = [];
                localStorage.setItem('leaderboard', JSON.stringify(leaderboard));
                updateLeaderboardDisplay();
            }
        }

        function updateLeaderboardDisplay() {
            leaderboardList.innerHTML = '';
            leaderboardListWin.innerHTML = '';
            
            leaderboard.forEach((player, index) => {
                const li = document.createElement('li');
                li.innerHTML = `<span>${index + 1}. ${player.name}</span> <span>${player.score}</span>`;
                leaderboardList.appendChild(li.cloneNode(true));
                leaderboardListWin.appendChild(li);
            });
        }

        function createClouds() {
            // Remove nuvens existentes
            document.querySelectorAll('.cloud').forEach(cloud => cloud.remove());
            
            // Cria 5 nuvens em posições aleatórias
            for (let i = 0; i < 5; i++) {
                const cloud = document.createElement('div');
                cloud.className = 'cloud';
                
                // Tamanho aleatório entre 50 e 150px
                const size = Math.random() * 100 + 50;
                cloud.style.width = `${size}px`;
                cloud.style.height = `${size * 0.6}px`;
                
                // Posição aleatória
                cloud.style.top = `${Math.random() * 200}px`;
                cloud.style.left = `${Math.random() * 700}px`;
                
                gameContainer.appendChild(cloud);
            }
        }

        // Inicializa o placar
        updateLeaderboardDisplay();
    </script>
</body>
</html>